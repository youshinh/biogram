# **AI Mix 機能仕様書 Part 1: 概念設計と要件定義**

## **プロジェクト名: Prompt-DJ "Deep Spectral Architect"**

### **1\. 概要と目的**

本機能は、従来のDJアプリにおける単調な「オートミックス（線形クロスフェード）」を廃止し、プロフェッショナルなアンビエント／テクノDJが用いる\*\*「スペクトル・ミキシング（周波数帯域の譲り合い）」**と**「有機的な操作感（揺らぎ）」\*\*をAIによって再現するシステムである。

**達成目標（100点の定義）:**

1. **Spectral Handoff:** 音量（Volume）だけでなく、EQとフィルタを駆使して低域（Bass）の衝突を完全に回避する。  
2. **Organic Feel:** 機械的な直線変化ではなく、人間特有の「迷い」「ためらい」「微調整」をカーブに含める。  
3. **Narrative:** 「予兆」から「余韻」、そして「浄化（リセット）」までの一連の流れを物語として構成する。  
4. **Generative:** エフェクトの自己発振などを利用し、楽曲に含まれない音響を生成して繋ぎに利用する。

### **2\. コア・アーキテクチャ: "Mix Phase Architecture"**

ロングミックス（32〜128小節）を単一のタイムラインではなく、以下の\*\*4つのフェーズ（位相）\*\*として定義し、AIに構成させる。

#### **Phase 1: Presence (予兆 / 導入)**

* **進行度:** 0% 〜 30%  
* **目的:** 次の曲（Incoming）の「気配」だけをフロアに漂わせる。  
* **聴覚状態:**  
  * Incomingの音量フェーダーは上がらない（または極小）。  
  * Incomingの Reverb Send や Delay Send をPre-Faderで送り、残響音だけをミックスする。  
  * EQ High や Filter HPF を使い、高域のシャカシャカした音（Hi-hats）だけを薄く混ぜる。

#### **Phase 2: Spectral Handoff (実体交換 / 展開)**

* **進行度:** 30% 〜 70%  
* **目的:** 楽曲の主役（Kick/Bass）を入れ替える。最も技術的なフェーズ。  
* **聴覚状態:**  
  * **Bass Swap:** Outgoing（前の曲）の低域を Filter HPF または EQ Low で削っていくのと同期して、Incomingの低域を挿入する。  
  * この瞬間、両方の曲の音量はほぼMAXだが、周波数帯域が棲み分けされているため濁らない。

#### **Phase 3: Wash Out (風化 / 余韻)**

* **進行度:** 70% 〜 100%  
* **目的:** 去りゆく曲（Outgoing）を物理的に遠ざけ、記憶の中に溶かす。  
* **聴覚状態:**  
  * Outgoingに対して Tape Echo のFeedbackを100%以上に上げ、音を滲ませる。  
  * Reverb のMixを上げ、音像を奥に引っ込める。  
  * 最後にVolumeフェーダーを下げる。

#### **Phase 4: Silent Reset (浄化 / 後処理)**

* **進行度:** 100% (Post-Mix)  
* **目的:** 次のミックスに向けた状態の初期化。  
* **動作:**  
  * Outgoing（現在は無音）のEQ、Filter、FXパラメータを、指定された待機時間（Wait Bars）を経て初期値（Flat/Dry）に戻す。  
  * これを怠ると、次にそのデッキに曲をロードした際、フィルタが掛かったまま再生される事故が起きる。

### **3\. 動作モード定義**

ユーザーは以下のモードを選択し、AIの振る舞いを決定する。

| モード名 | ターゲットジャンル | 特徴 | Mix Duration目安 |
| :---- | :---- | :---- | :---- |
| **Deep Blend** | Ambient, Deep Techno | フィルタとEQによるロングミックス重視。激しい変化を避ける。 | 64 \- 128 Bars |
| **Rhythmic Swap** | Hard Techno, House | SlicerとGateを使用し、リズムを刻みながらカットイン気味に繋ぐ。 | 16 \- 32 Bars |
| **Chaos Gen** | Experimental, Dub | Delay発振、Bitcrusherを多用し、ノイズの壁を作って強制転換する。 | 8 \- 16 Bars |
| **Cinema** | Soundtrack | ReverbのFreeze機能（Eternal Freeze）を使い、ドローン音で繋ぐ。 | Free |

### **4\. 必須技術要件**

* **Stereo Processing:** 空間エフェクトの効果を最大化するため、DSPチェーンは完全ステレオであること。  
* **Lookahead:** AI生成のレイテンシを隠蔽するため、再生位置より「最低4小節分」先行してデータをリクエストするプリロード機構。  
* **Curve Interpolation:** 直線補間だけでなく、S字（Sigmoid）、指数（Exp）、揺らぎ（Wobble）を計算できる補間エンジン。